<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Sports AI Coach Chatbot</title>
<style>
body { font-family: Arial; background: #f0f2f5; padding: 20px; }
#chatbox { width: 100%; max-width: 600px; margin: auto; background: #fff; padding: 15px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
.message { margin: 10px 0; }
.user { text-align: right; color: blue; }
.ai { text-align: left; color: green; }
#inputBox { width: 100%; display: flex; margin-top: 10px; }
#question { flex: 1; padding: 10px; border-radius: 5px; border: 1px solid #ccc; }
#sendBtn { padding: 10px 15px; margin-left: 5px; border: none; border-radius: 5px; background: #007bff; color: white; cursor: pointer; }
#sendBtn:hover { background: #0056b3; }
#suggestions { margin-top: 10px; font-size: 0.9em; color: #555; }
.suggestion { cursor: pointer; color: #007bff; margin-right: 10px; }
.suggestion:hover { text-decoration: underline; }
</style>
</head>
<body>
<h2>Sports AI Coach Chatbot</h2>
<div id="chatbox"></div>
<div id="inputBox">
  <input type="text" id="question" placeholder="질문을 입력하세요..." />
  <button id="sendBtn">전송</button>
</div>
<div id="suggestions"></div>

<script>
const chatbox = document.getElementById('chatbox');
const questionInput = document.getElementById('question');
const sendBtn = document.getElementById('sendBtn');
const suggestionsDiv = document.getElementById('suggestions');
let suggestions = ["요트는 어떻게 타?", "체조 훈련 루틴 추천해줘", "야구 투수 훈련 알려줘", "아이스하키 포지션 설명해줘"];
updateSuggestions();

function updateSuggestions() {
    suggestionsDiv.innerHTML = "";
    suggestions.forEach(s => {
        const span = document.createElement("span");
        span.textContent = s;
        span.className = "suggestion";
        span.onclick = () => sendQuestion(s);
        suggestionsDiv.appendChild(span);
    });
}

async function sendQuestion(question) {
    if (!question) return;
    appendMessage("user", question);
    questionInput.value = "";
    try {
        const resp = await fetch("/api/ask", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ question })
        });
        const data = await resp.json();
        let answer = data.answer || "AI 응답 생성 중 오류가 발생했습니다.";
        appendMessage("ai", answer);
        suggestions = suggestions.filter(s => s !== question);
        suggestions.unshift(question + " 관련 추가 질문?");
        if (suggestions.length > 4) suggestions.pop();
        updateSuggestions();
    } catch(e) {
        appendMessage("ai", "AI 응답 생성 중 오류가 발생했습니다.");
    }
}

function appendMessage(sender, text) {
    const div = document.createElement("div");
    div.className = message ;
    div.textContent = text;
    chatbox.appendChild(div);
    chatbox.scrollTop = chatbox.scrollHeight;
}

sendBtn.onclick = () => sendQuestion(questionInput.value);
questionInput.addEventListener("keypress", function(e) {
    if (e.key === "Enter") {
        sendQuestion(questionInput.value);
    }
});
</script>
</body>
</html>
